# ドメイン管理：データモデリングにおける重要性とメリット・デメリット

## ドメイン管理とは何か

データモデリングにおける「ドメイン管理」とは、複数の属性に横断して存在するデータの意味や取りえる値のルールを定義し、それらと属性の紐付けを作成・維持することである。DMBOKでは「属性の定義域（ドメイン）」を「各属性が取りえるすべての値一式」として定義している。

ドメインの概念は数学の「関数の定義域（Domain of function）」に由来すると考えられており、ドメイン駆動設計やネットワークドメインとは異なる概念である。

### 具体例による理解

社員管理システムの「社員ID」を例にとると、以下のような意味・ルールが定義される：

- 社員一人一人に割り振られる一意の識別子
- 入社時に割り振られ、退職まで変わることはない
- 退職者の社員IDは再利用されない
- 先頭1文字はA or Bで、その後ろに6桁の数字（ゼロ埋めあり）で合計7桁の文字列

このドメインは「社員.社員ID」だけでなく「社員.上司ID」にも適用される。同様に「社員.部署ID」と「部署.部署ID」、「社員.電話番号」と「社員.緊急連絡先」なども共通のドメインを持つ。

## ドメイン管理のメリット

### 1. 属性命名の標準化と品質向上

属性命名には「[修飾語] + [主要語] + [区分語]」のルールが推奨される：

- 修飾語：属性固有の意味（例：上司、所属）
- 主要語：属性が指している対象（例：社員、部署）
- 区分語：値の種類（例：ID、名）

ドメイン管理により「主要語 + 区分語」がドメイン名と一致するため、命名の揺れを抑制し、機械的な命名とそのチェックが容易になる。「上司ID」ではなく「上司社員ID」のような明確な命名が可能となる。

### 2. データ型修正時の影響範囲明確化

システム改修でデータ型を変更する場合、同じ意味を持つ属性をすべて修正する必要がある。住所の最大文字列長を拡張する際、全属性から住所関連カラムを洗い出すのは困難だが、ドメイン管理では一箇所の修正で済む。

属性とドメインの対応関係により影響範囲の調査が効率化され、データ型変更以外の修正（氏名を姓・名に分割など）の影響範囲調査にも活用できる。

### 3. 属性設計の標準化促進

要件や設計者によって生じる属性設計のブレを防ぐ。例えば：

**住所の場合：**
- 1つの文字列として保持するか、都道府県コード + 市区町村 + 町名・番地 + 建物名に分割するか
- 外部ツールによるクレンジングや記述統一の可否

**金額の場合：**
- 円貨か外貨か
- 小数点を許すか
- 消費税を含むか

事前にドメインとして定義することで統一を図り、設計者に細かい意味の違いを意識させることができる。

## ドメイン管理のデメリットと課題

### 1. 管理体制の複雑化

従来はプロジェクト内のDBAチームが集中的にドメイン管理を担当していたが、現在は各機能チームで分散実施するケースが増加。その結果、集中的にドメインを管理する役割が不明確になっている。

### 2. アプリケーション重視への移行

データベースレベルでの意味や値のルール管理よりも、アプリケーション側での管理が主流となっている。これによりドメイン管理の必要性が相対的に低下している。

### 3. 管理コストの高さ

ドメイン管理は手間がかかる一方で、それだけでは解決できない問題も多い：

- ルールの強制や遵守状況のモニタリング
- 属性独自の意味の管理
- ドメインの階層化の困難さ（A5:SQL Mk-2の場合）
- コメントの記述制限（改行不可など）

## デメリット緩和の現実的な方法

### 1. 自動化技術の活用

**ドメインの意味・ルールの自動生成：**
- 生成AIを活用してドメインの意味やルールを一般常識や業務ドキュメントから自動生成
- 手動での詳細記述作業の軽減

**ドメインの自動判定：**
- 属性名やデータの中身を分析した自動ドメイン判定システム
- 過去の属性+データとドメインの紐付けペアを学習データとして活用
- 多くのデータカタログツールの個人識別情報（PII）自動推測機能の拡張

**技術メタデータからの自動判定：**
- リネージや外部キー制約などのテクニカルメタデータを活用した自動判定
- 人手による判定作業の削減

### 2. 段階的導入アプローチ

**コアドメインの優先実装：**
- 最も影響範囲の大きいドメイン（ID系、金額系、日付系）から開始
- 全ドメインの一括管理ではなく、重要度に応じた段階的導入

**ツール選択の最適化：**
- プロジェクト規模に応じたツール選択
- A5:SQL Mk-2の制限を回避できる上位ツールの検討

### 3. ガバナンス体制の確立

**責任分担の明確化：**
- ドメイン管理の責任者とプロセスの明文化
- 機能チーム分散開発でもドメイン一貫性を保つルール策定

**レビュープロセスの組み込み：**
- 新規属性追加時のドメイン適合性チェック
- 定期的なドメイン定義の見直しプロセス

## 批判的視点・反論

ドメイン管理の効果について懐疑的な意見も存在する。特に現代のアジャイル開発においては、厳密なドメイン管理が開発速度を阻害する可能性がある。また、マイクロサービスアーキテクチャでは各サービスが独自のデータ管理を行うため、横断的なドメイン管理の意義が薄れるという指摘もある。

しかし、複数システムのデータを集約・統合して活用する現代のデータドリブン経営においては、何らかの形でのドメイン管理は不可欠である。問題は実装方法であり、従来の重厚な管理手法ではなく、自動化と最小限のガバナンスを組み合わせたアプローチが求められている。

## 関連ノート

- [[データ主権とは何か]]
- [ドメイン管理のデータモデリングにおける重要性](https://qiita.com/abe_masanori/items/371d61048b7654cf4be5)

#datamodel #domain #design/database #er


[//begin]: # "Autogenerated link references for markdown compatibility"
[データ主権とは何か]: %E3%83%87%E3%83%BC%E3%82%BF%E4%B8%BB%E6%A8%A9%E3%81%A8%E3%81%AF%E4%BD%95%E3%81%8B.md "データ主権とは何か"
[//end]: # "Autogenerated link references"
