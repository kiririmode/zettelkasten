# ADF検定（Augmented Dickey-Fuller test）とは何か、その考え方

## 概要
ADF検定は、時系列データが「単位根（unit root）」を持つかどうか、すなわち“非定常”かどうかを統計的に判定するための検定です。単位根が存在する場合、時系列は平均や分散が時間とともに変化しやすく、ARIMAなどのモデル適用前に差分を取る必要があります。

## 検定の基本的な考え方
- **帰無仮説（H0）**：「単位根が存在する（＝非定常）」
- **対立仮説（H1）**：「単位根が存在しない（＝定常）」

ADF検定では、時系列データに自己回帰モデル（ARモデル）を当てはめ、単位根の有無を判定します。検定統計量が臨界値より小さければ、帰無仮説を棄却＝「定常」と判断します。

## 単位根（unit root）とは何か

単位根とは、時系列モデル（特に自己回帰モデル：ARモデル）の特性方程式の根（解）が1になることを指します。

たとえば、AR(1)モデルの場合：

$$
X_t = \phi X_{t-1} + \varepsilon_t
$$

このとき、$\phi = 1$ であれば「単位根が存在する」と言います。

### 単位根があるとどうなるか

- 単位根があると、時系列データは“非定常”となり、平均や分散が時間とともに変化しやすくなります。
- 具体的には、過去のショック（$\varepsilon_t$）の影響が永続的に残り、データがランダムウォークのように漂う性質を持ちます。
- 逆に、$\phi < 1$ であれば、ショックの影響は時間とともに減衰し、平均値に戻る傾向（定常性）を持ちます。

### 直感的なイメージ

- 単位根あり：コイン投げの累積和のように、どこまでも漂い続ける（ランダムウォーク）
- 単位根なし：平均値の周りに収束しやすい

### 反証的・批判的視点

- 単位根があるかどうかは、時系列モデルの選択や前処理（差分化など）に大きく影響します。
- 実データでは、トレンドや構造変化、季節性などが混在し、単純な単位根過程だけで説明できない場合も多いです。

## 自己回帰モデルと単位根の関係
AR(1)モデル：

$$
X_t = \phi X_{t-1} + \varepsilon_t
$$

- $\phi = 1$ のとき「単位根過程」
- $\phi < 1$ なら、過去のショック（$\varepsilon_t$）の影響は時間とともに減衰し、$X_t$は平均値に戻る傾向＝定常
- $\phi = 1$ だと、ショックの影響が永続的に残り、平均や分散が時間とともに発散＝非定常

ADF検定では、ARモデルの係数$\phi$が1かどうか（単位根の有無）を統計的に検証します。実際には次のような形に変形して検定します：

$$
X_t - X_{t-1} = \delta X_{t-1} + ... + \varepsilon_t \\
\delta = \phi - 1
$$

- $\delta = 0$（$\phi = 1$）なら単位根あり＝非定常
- $\delta < 0$（$\phi < 1$）なら単位根なし＝定常

この$\delta$が0かどうかをt検定で判定することで、単位根の有無がわかります。

## 直感的なまとめ
- ARモデルの係数が1かどうか＝「過去の影響が消えるか残るか」を見ている
- 係数が1なら、どんなショックも永遠に残る（非定常）
- 係数が1未満なら、ショックはやがて消える（定常）

## 反証的・批判的視点
- ADF検定は「単位根がない＝定常」とは限らず、トレンド定常や構造変化には弱い
- サンプルサイズやラグの選び方によって結果が変わることがある
- KPSS検定など他の検定と併用するのが実務的

## 関連・リンク推奨
- [[定常性とは何か_その判定方法]]
- [[SARIMAによる時系列異常検知の基礎]]
- [[時系列データの前処理]]
- [[ARIMAモデルの基礎]]

## タグ
#時系列解析 #定常性 #adf #単位根 #arima #統計モデル

[//begin]: # "Autogenerated link references for markdown compatibility"
[定常性とは何か_その判定方法]: %E5%AE%9A%E5%B8%B8%E6%80%A7%E3%81%A8%E3%81%AF%E4%BD%95%E3%81%8B_%E3%81%9D%E3%81%AE%E5%88%A4%E5%AE%9A%E6%96%B9%E6%B3%95.md "定常性とは何か、その判定方法"
[SARIMAによる時系列異常検知の基礎]: SARIMA%E3%81%AB%E3%82%88%E3%82%8B%E6%99%82%E7%B3%BB%E5%88%97%E7%95%B0%E5%B8%B8%E6%A4%9C%E7%9F%A5%E3%81%AE%E5%9F%BA%E7%A4%8E.md "SARIMAによる時系列異常検知の基礎"
[//end]: # "Autogenerated link references"
