# BedrockをVPC Endpoint経由以外で利用許可しない構成は可能か？

## 概要
Amazon Bedrockの利用を「VPC Endpoint（PrivateLink）経由のみに限定し、インターネット経由のアクセスを拒否する」構成は、**IAMアイデンティティベースポリシー**と**VPCエンドポイントのエンドポイントポリシー**を組み合わせることで実現可能です。

ただし、**Bedrock自体はリソースベースポリシー（リソースポリシー）をサポートしていません**。S3など一部サービスと異なり、Bedrockリソースに直接リソースポリシーを付与してVPC Endpoint経由のみ許可することはできません。

---

## 技術的な実現方法

### 1. VPC Endpoint（PrivateLink）の利用
- BedrockはInterface型VPC Endpointをサポートしており、VPC内リソースからプライベートにアクセス可能。
- VPC Endpoint経由でのみAPI通信を許可する設計が推奨される。
- インターネットゲートウェイやNAT不要、パブリックIPも不要。

### 2. エンドポイントポリシーによるアクセス制御
- VPCエンドポイントには「エンドポイントポリシー（リソースベース）」を設定可能。
- 例：
```json
{
   "Version": "2012-10-17",
   "Statement": [
      {
         "Principal": "*",
         "Effect": "Allow",
         "Action": [
            "bedrock:InvokeModel",
            "bedrock:InvokeModelWithResponseStream"
         ],
         "Resource":"*"
      }
   ]
}
```
- このポリシーをカスタマイズし、特定のIAMロールやアクション、リソースに限定することができる。
- Bedrockリソース自体にリソースポリシーは設定できない点に注意。

### 3. IAM・SCPによる補強
- IAMユーザーやロールの権限設計も重要。管理者権限の乱用やポリシー変更の抜け道を防ぐため、SCPやpermission boundaryも併用するのが望ましい。
- [[permission_boundaryとは何か]] も参照。

---

## 注意点・反証的視点
- Bedrockの一部機能や管理系APIでVPC Endpoint未対応のものが将来的に出る可能性もゼロではない（AWSサービスの仕様変更に注意）。
- VPC Endpointの障害時はサービス利用が全面的に止まるリスクもある。
- AWS OrganizationsやSCPでの制御も併用するとより堅牢だが、組織全体の設計が必要。
- IAM権限の設計ミスや、エンドポイントポリシーの適用漏れがあると抜け道が生じるため、定期的な監査・検証が必須。
- S3など一部サービスはリソースポリシーでVPC制限が可能だが、Bedrockは未対応。

---

## 公式ドキュメント裏どり
- [How Amazon Bedrock works with IAM](https://docs.aws.amazon.com/bedrock/latest/userguide/security_iam_service-with-iam.html)（リソースポリシー: Noと明記）
- [Bedrock VPCエンドポイント公式ガイド](https://docs.aws.amazon.com/bedrock/latest/userguide/vpc-interface-endpoints.html)
- [VPCエンドポイントのアクセス制御](https://docs.aws.amazon.com/vpc/latest/privatelink/vpc-endpoints-access.html)

---

## 関連ノート・リンク案
- [[Bedrock_Provisioned_ThroughputとMUの基礎]]
- [[Bedrock_Prompt_Managementとは何か]]
- [[permission_boundaryとは何か]]
- [[Terraform_MCP_Server_概要とユースケース]]

---

#aws/bedrock #aws #vpc #security #設計方針


[//begin]: # "Autogenerated link references for markdown compatibility"
[permission_boundaryとは何か]: permission_boundary%E3%81%A8%E3%81%AF%E4%BD%95%E3%81%8B.md "permission boundary（パーミッションバウンダリ）とは何か"
[Bedrock_Provisioned_ThroughputとMUの基礎]: Bedrock_Provisioned_Throughput%E3%81%A8MU%E3%81%AE%E5%9F%BA%E7%A4%8E.md "BedrockのProvisioned Throughputとモデルユニット（MU）について"
[Bedrock_Prompt_Managementとは何か]: Bedrock_Prompt_Management%E3%81%A8%E3%81%AF%E4%BD%95%E3%81%8B.md "Amazon Bedrock Prompt Management とは何か"
[Terraform_MCP_Server_概要とユースケース]: Terraform_MCP_Server_%E6%A6%82%E8%A6%81%E3%81%A8%E3%83%A6%E3%83%BC%E3%82%B9%E3%82%B1%E3%83%BC%E3%82%B9.md "Terraform MCP Server（hashicorp/terraform-mcp-server）概要・機能・ユースケース"
[//end]: # "Autogenerated link references"
