# CAAレコードとは何か

## 定義・概要
CAA（Certification Authority Authorization）レコードは、DNSに設定することで、ドメイン所有者が「どの認証局（CA）が自分のドメインのSSL/TLS証明書を発行できるか」を明示的に指定できる仕組みです。IETFによるRFC 8659で標準化されており、インターネットの信頼性とセキュリティを高めるために導入されました。

## 仕組みと認証局の利用方法
認証局（CA）は、証明書発行リクエストを受けた際、必ずそのドメインのCAAレコードをDNS経由で確認します。CAAレコードが設定されていれば、そこに記載されたCAのみが証明書を発行できます。たとえば `letsencrypt.org` だけが許可されていれば、他のCAは発行できません。CAAレコードがなければ、従来通りどのCAでも発行可能です。

### 認証局の具体的な手順
1. 証明書発行申請を受けたら、CAはDNSにCAAレコードがあるか問い合わせる。
2. レコードが存在し、かつ自分（CA）が許可されていれば発行を進める。
3. 許可されていなければ発行を拒否し、申請者にエラーを返す。
4. CAAレコードがなければ、従来通り発行可能。

この仕組みにより、ドメイン所有者は「どのCAから証明書を発行するか」をコントロールでき、不正発行やなりすましリスクを低減できます。

## 詳細コンテンツ
CAAレコードは、主に不正な証明書発行（なりすましや誤発行）を防ぐために設計されました。過去にはDigiNotar事件など、認証局がドメイン所有者の意図に反して証明書を発行し、攻撃者による中間者攻撃やフィッシングが可能となる重大なインシデントが発生しています。CAAレコードを利用することで、ドメイン所有者はDNS上で許可する認証局を指定し、それ以外のCAによる証明書発行を防止できます。

CAAレコードの設定例：
```
example.com.  IN  CAA 0 issue "letsencrypt.org"
```
この例では、Let's Encrypt以外の認証局はexample.comの証明書を発行できません。

## 批判的視点・反論
- CAAレコードがあっても、すべての認証局が必ずしも正しく参照・遵守するとは限りません。
- DNSのセキュリティ（例：DNSSEC未導入時の改ざんリスク）に依存する側面があります。
- 運用ミスや設定忘れによる正当な証明書発行の阻害リスクも存在します。
- DNS障害や伝播遅延によって、正当な証明書発行が一時的に妨げられる可能性もあります。

## 関連ノート/リンク
- [[DigiNotar事件_証明書不正発行の教訓]]
- [[SSL/TLS証明書の信頼モデルと課題]]
- [[DNSSECとは何か_セキュリティ強化の仕組み]]
- [[RFCとは何か_インターネット標準の仕組み]]
- [[DNSレコードの標準化と実装の違い]]

#dns #certificate #security #rfc
