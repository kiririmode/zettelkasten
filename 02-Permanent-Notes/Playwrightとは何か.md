# Playwrightとは何か

## 定義・概要
PlaywrightはMicrosoftが開発したオープンソースのE2E（エンドツーエンド）テスト自動化フレームワークである。Webアプリケーションのユーザー操作をプログラムで再現し、実際のブラウザ上で動作検証を行うことができる。主要なブラウザ（Chromium, Firefox, WebKit）をサポートし、クロスブラウザテストが容易。

## Playwrightの特徴と技術要素
- 公式サポートの3大ブラウザエンジン（Chromium, Firefox, WebKit）
- ヘッドレス・ヘッドフル両対応
- APIモック・ネットワーク制御
- 自動待機（auto-wait）機能：要素の表示・有効化・アニメーション終了などを自動判定して待機し、テストの信頼性・安定性を高める
- 多言語対応（TypeScript/JavaScript, Python, C#, Java）
- 強力なデバッグツール（trace viewer, codegen）、自動生成されるテストコード、詳細なエラーレポート

## Playwrightの自動待機（auto-wait）機能とは
Playwrightの自動待機機能（auto-wait）は、テストコード内で要素の操作（クリック、入力、取得など）を行う際、対象の要素が「利用可能な状態」になるまで自動的に待機する仕組みです。たとえば、ボタンが非表示・無効・未描画の場合でも、Playwrightはその要素が「表示され、操作可能」になるまで自動で待ちます。

- ページ遷移やAjax通信で要素の描画が遅れる場合でも、明示的な`wait`や`sleep`を多用せず、`page.click('button')`のような操作だけで安定したテストが書ける。
- クリックや入力、取得などの操作ごとに、要素の表示・有効化・アニメーション終了などを自動判定して待機する。
- テストの信頼性・安定性が向上し、「タイミング依存の失敗（フレーク）」が減る。
- SeleniumやPuppeteerでは明示的な`wait`や`sleep`を多用しがちだが、Playwrightは自動で最適なタイミングを判断するため、テストの記述量と失敗率が大きく減少する。

## Selenium・Puppeteerとの比較

### Seleniumとの比較
- **クロスブラウザ対応**：Seleniumも主要ブラウザをサポートするが、PlaywrightはWebKit（Safariエンジン）まで公式サポートし、1つのAPIで全ブラウザを同等に扱える。
- **自動待機**：Playwrightは要素の状態変化を自動で待機する仕組みが標準で備わっており、Seleniumよりもテストの安定性が高い。
- **API設計・開発体験**：PlaywrightはAPI設計がシンプルで、デバッグやトレース機能も充実。Seleniumは多言語対応が強みだが、APIの一貫性や最新Web技術への追従ではPlaywrightが優れる。

### Puppeteerとの比較
- **対応ブラウザ**：Puppeteerは基本的にChromium系のみ対応だが、PlaywrightはChromium・Firefox・WebKitを公式サポート。
- **機能の幅**：Playwrightは複数タブ・ウィンドウ、iframe、ネットワークモック、APIモックなど、より幅広い機能を標準で提供。
- **自動待機や安定性**：Puppeteerは明示的な待機が必要な場面が多いが、Playwrightは自動待機機能によりテストの信頼性が高い。

### 共通点と選択の観点
- いずれもWebアプリのE2Eテスト自動化を目的とし、ブラウザ操作をプログラムで再現できる点は共通。
- 既存資産やチームのスキルセット、対象ブラウザ、CI/CDとの統合要件などを考慮して選択するのが実践的。

## 反証・異論となる視点
- SeleniumやCypressなど既存ツールからの移行には学習コストが発生する。
- Web以外のE2Eには非対応（モバイルアプリやデスクトップアプリは対象外）。
- UIの頻繁な変更がある場合、テストコードの保守コストが増大するリスク。

## 関連ノート・リンク案
- [[E2Eテスト自動化のベストプラクティス]]
- [[SeleniumとPlaywrightの比較]]
- [[CI/CDパイプラインにおけるテスト自動化]]
- [[Webアプリの品質保証戦略]]

## タグ
#playwright #e2eテスト #自動化 #テスト戦略 #クロスブラウザ
