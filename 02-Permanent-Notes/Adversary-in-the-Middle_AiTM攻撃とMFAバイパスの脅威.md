# Adversary-in-the-Middle（AiTM）攻撃とMFAバイパスの脅威

## 概要
Adversary-in-the-Middle（AiTM）攻撃は、従来のMan-in-the-Middle（MitM）攻撃を発展させたサイバー攻撃手法であり、特に多要素認証（MFA）をバイパスする高度な認証突破を狙う点が特徴です。近年、クラウドサービスやリモート開発環境の普及に伴い、AiTM攻撃のリスクが増大しています。

## 仕組みと特徴
- 攻撃者は被害者と正規サービスの間に不正な中継サーバを設置し、通信内容をリアルタイムで盗聴・改ざんします。
- ユーザーがID・パスワード、MFAコードを入力すると、攻撃者はそれらを即座に正規サービスへ転送し、認証済みセッショントークンを奪取します。
- これにより、攻撃者はMFAを突破し、被害者になりすましてサービスへアクセスできるようになります。

## MFAバイパスの具体的な流れ
1. ユーザーは攻撃者が用意した偽のログインページ（フィッシングサイト）に誘導される。
2. 入力されたID・パスワード・MFAコードが攻撃者経由で正規サイトに転送される。
3. 攻撃者はリアルタイムでセッショントークンを奪取し、以降はMFAなしでサービスにアクセス可能となる。

## なぜMFAが無効化されるのか
- MFAコードは一度きりだが、攻撃者がリアルタイムで中継するため、ユーザーと同じタイミングで認証を突破できる。
- セッショントークンを奪われると、追加認証なしでしばらくの間サービス利用が可能。
- SMSやTOTP型MFAはこの手法に弱い。

## 反証・異論となる視点
- 物理デバイス（FIDO2/U2Fキー等）を使ったMFAは、セッションの中継や複製が困難なため、AiTM攻撃にも比較的強い。
- サービス側で地理的・端末的な異常検知や、MFA後の追加認証を導入することで被害を抑制できる。
- ゼロトラストネットワークなど多層防御の設計が重要。

## 関連ノート・リンク
- [[ゼロトラストネットワークとは何か]]：MFAバイパスを前提とした多層防御の重要性
- [[Claude_Code_ネットワーク要件まとめ]]：安全な認証設計の観点

---

#aitm #mitm #security #mfa #フィッシング #ゼロトラスト


[//begin]: # "Autogenerated link references for markdown compatibility"
[ゼロトラストネットワークとは何か]: %E3%82%BC%E3%83%AD%E3%83%88%E3%83%A9%E3%82%B9%E3%83%88%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF%E3%81%A8%E3%81%AF%E4%BD%95%E3%81%8B.md "ゼロトラストネットワークとは何か"
[Claude_Code_ネットワーク要件まとめ]: Claude_Code_%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF%E8%A6%81%E4%BB%B6%E3%81%BE%E3%81%A8%E3%82%81.md "Claude Codeに必要なネットワーク要件まとめ"
[//end]: # "Autogenerated link references"
