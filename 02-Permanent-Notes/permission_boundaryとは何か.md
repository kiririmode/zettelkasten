# permission boundary（パーミッションバウンダリ）とは何か

## 定義
IAMのpermission boundary（パーミッションバウンダリ）は、IAMユーザーやロールに対して「この範囲までしか権限を与えない」という“上限”を設定する仕組みです。AWSマネージドポリシーまたはカスタマーマネージドポリシーをバウンダリとして指定し、エンティティの権限を制限します。

## 仕組みと評価ロジック
- 実際の権限は「アイデンティティベースポリシー」と「permission boundary」の両方で許可された操作のみ有効（AND条件）。
- バウンダリ自体は権限を“付与”しません。あくまで「この範囲までしか許可しない」という“制限”です。
- 明示的Denyがどこかにあれば、Allowより優先されます。
- resource-based policyで直接許可された場合、バウンダリの制限を受けないケースもあります（特にセッションARNやフェデレーテッドユーザーの場合）。

## 代表的なユースケース
### 1. 部分的な権限委譲の安全性確保
開発チームの管理者に「IAMユーザー作成」権限（`iam:CreateUser`）を付与する場合、permission boundaryで「S3/CloudWatch/EC2のみ許可」と設定すれば、開発チームが作成するユーザーの権限範囲を制限できます。これにより、過剰な権限付与を防ぎつつ、現場の自律性も確保できます。

### 2. サービスアカウントの権限上限設定
自動化ツールやCI/CDパイプライン用のロールに対し、permission boundaryで「このロールはS3とEC2のみ操作可能」といった上限を設けることで、運用担当者が誤って広範な権限を付与しないようにできます。

### 3. マルチテナント環境での権限制御
複数チーム・部門が同一AWSアカウントを利用する場合、各チームの管理者にユーザー・ロール作成権限を与えつつ、permission boundaryで「自分の担当サービスのみ操作可能」と制限できます。

## 具体例
- 例：`ShirleyRodriguez`ユーザーにS3/CloudWatch/EC2のみ許可するバウンダリを設定すると、IAMのCreateUser権限を付与しても、バウンダリで許可されていなければ実行できません。

## 注意点・ベストプラクティス
- resource-based policyで`NotPrincipal`＋Denyを使うと、バウンダリ付きIAMユーザー/ロールが意図せずアクセス不能になる場合があるため、`ArnNotEquals`＋`aws:PrincipalArn`の利用が推奨されます。
- バウンダリと通常ポリシー、SCPなど複数の制御が重なると、実効権限の把握が難しくなります。

## 反証・異論となる視点
- バウンダリは万能ではなく、リソースベースポリシーや一部サービスの特殊な権限制御には適用されません。
- 複雑化のリスクがあり、運用時は可視化や定期的な見直しが重要です。

---

### 関連ノート・リンク案
- [[IAMポリシーの種類と設計原則]]
- [[最小権限の原則と運用課題]]
- [[SCP/パーミッションバウンダリの違いと使い分け]]

---

#aws #iam #permissionboundary #権限管理 #security
